# tp4- Redes y Comunicaciones

---

1. ¬øQu√© protocolos se utilizan para el env√≠o de mails entre el cliente y su servidor de
correo? ¬øY entre servidores de correo?

![image.png](image.png)

### üì§ Env√≠o de mails **del cliente al servidor** de correo:

El protocolo principal es:

- **SMTP (Simple Mail Transfer Protocol)**:
    
    Es el protocolo que se usa para **enviar** correos electr√≥nicos desde un cliente (como Outlook, Thunderbird o una app de mail) al servidor. Tambi√©n se usa entre servidores, ahora lo vemos.
    

> ‚úâÔ∏è Por ejemplo: cuando escrib√≠s un mail y toc√°s ‚ÄúEnviar‚Äù, tu cliente usa SMTP para mandarlo al servidor saliente.
> 

---

### üì¨ Para **recibir** mails del servidor al cliente, se usan:

- **POP3 (Post Office Protocol, versi√≥n 3)**:
    
    Descarga los mails del servidor al dispositivo y por defecto los borra del servidor. Es m√°s simple y consume menos recursos, pero no sirve mucho si quer√©s acceder al mismo mail desde varios dispositivos.
    
- **IMAP (Internet Message Access Protocol)**:
    
    A diferencia de POP3, mantiene los mails en el servidor y sincroniza en tiempo real, ideal si us√°s el mail desde varios dispositivos (celu, compu, etc.).
    

> ‚ú® IMAP hoy en d√≠a es mucho m√°s com√∫n que POP3.
> 

---

### üîÅ Entre **servidores de correo** (por ejemplo, cuando Gmail le manda un mail a Outlook):

- Tambi√©n se usa **SMTP**.
    
    Ac√° el protocolo se encarga de que el mensaje viaje de un servidor a otro hasta llegar al destinatario.
    

---

### Resumen:

| Acci√≥n | Protocolo |
| --- | --- |
| Enviar mail (cliente ‚Üí servidor) | SMTP |
| Enviar mail (servidor ‚Üí servidor) | SMTP |
| Recibir mail (servidor ‚Üí cliente) | POP3 o IMAP |

1. ¬øQu√© protocolos se utilizan para la recepci√≥n de mails? Enumere y explique
caracter√≠sticas y diferencias entre las alternativas posibles.

### üì• ¬øQu√© protocolos se utilizan para **la recepci√≥n de mails**?

Los dos protocolos principales son:

---

### 1. **POP3 (Post Office Protocol version 3)**

### üß© Caracter√≠sticas:

- **Conexi√≥n simple y directa**: el cliente se conecta al servidor, descarga los mails y (por defecto) los **elimina** del servidor.
- Guarda los correos **localmente** en tu dispositivo.
- No sincroniza cambios entre dispositivos (si borr√°s un mail en el celu, sigue estando en la compu).

### ‚úÖ Ventajas:

- Menor uso de almacenamiento en el servidor.
- Ideal para usar con un solo dispositivo.

### ‚ùå Desventajas:

- No ves los mismos mails en varios dispositivos.
- Si perd√©s el dispositivo o no hac√©s copia, perd√©s los mails.

---

### 2. **IMAP (Internet Message Access Protocol)**

### üß© Caracter√≠sticas:

- Acced√©s a los correos **directamente en el servidor**.
- Sincronizaci√≥n en tiempo real entre varios dispositivos.
- Los cambios (leer, borrar, mover, etc.) se reflejan en todos los lugares donde accedas al correo.

### ‚úÖ Ventajas:

- Perfecto para usar el mail desde distintos dispositivos.
- No perd√©s mails si se rompe tu compu o celular.

### ‚ùå Desventajas:

- Ocupa m√°s espacio en el servidor.
- Requiere conexi√≥n estable a internet para funcionar bien.

---

### üÜö Diferencias clave entre IMAP y POP3:

| Caracter√≠stica | POP3 | IMAP |
| --- | --- | --- |
| Almacenamiento | Local | En el servidor |
| Sincronizaci√≥n | No sincroniza | Sincroniza en tiempo real |
| Acceso desde varios equipos | Limitado | Totalmente posible |
| Uso de espacio en servidor | Menor | Mayor |
| Ideal para... | Un solo dispositivo | Varios dispositivos |

---

En resumen, **IMAP** es m√°s moderno y flexible, y suele ser la opci√≥n por defecto hoy en d√≠a. **POP3** es m√°s antiguo y limitado, aunque todav√≠a se usa en casos espec√≠ficos.

1. Utilizando la VM y teniendo en cuenta los siguientes datos, abra el cliente de correo
(Thunderbird) y configure dos cuentas de correo. Una de las cuentas utilizar√° POP para
solicitar al servidor los mails recibidos para la misma mientras que la otra utilizar√° IMAP.
Al crear cada una de las cuentas, seleccionar Manual config y luego de configurar las
mismas seg√∫n lo indicado, ignorar advertencias por uso de conexi√≥n sin cifrado.
‚óè Datos para POP
Cuenta de correo: [alumnopop@redes.unlp.edu.ar](mailto:alumnopop@redes.unlp.edu.ar)
Nombre de usuario: alumnopop
Contrase√±a: alumnopoppass
Puerto: 110
‚óè Datos para IMAP
Cuenta de correo: [alumnoimap@redes.unlp.edu.ar](mailto:alumnoimap@redes.unlp.edu.ar)
Nombre de usuario: alumnoimap
Contrase√±a: alumnoimappass
Puerto: 143
‚óè Datos comunes para ambas cuentas
Servidor de correo entrante (POP/IMAP):
‚Ä¢ Nombre: [mail.redes.unlp.edu.ar](http://mail.redes.unlp.edu.ar/)
‚Ä¢ SSL: None
‚Ä¢ Autenticaci√≥n: Normal password
Servidor de correo saliente (SMTP):
‚Ä¢ Nombre: [mail.redes.unlp.edu.ar](http://mail.redes.unlp.edu.ar/)
‚Ä¢ Puerto: 25
‚Ä¢ SSL: None
‚Ä¢ Autenticaci√≥n: Normal password
a. Verificar el correcto funcionamiento enviando un email desde el cliente de
una cuenta a la otra y luego desde la otra responder el mail hacia la primera.
b. An√°lisis del protocolo SMTP
    
    i. Utilizando Wireshark, capture el tr√°fico de red contra el servidor de
    correo mientras desde la cuenta [alumnopop@redes.unlp.edu.ar](mailto:alumnopop@redes.unlp.edu.ar) env√≠a
    un correo a [alumnoimap@redes.unlp.edu.ar](mailto:alumnoimap@redes.unlp.edu.ar)
    
    ![image.png](image%201.png)
    
    ii. Utilice el filtro SMTP para observar los paquetes del protocolo SMTP
    en la captura generada y analice el intercambio de dicho protocolo
    entre el cliente y el servidor para observar los distintos comandos
    utilizados y su correspondiente respuesta. Ayuda: filtre por protocolo
    SMTP y sobre alguna de las l√≠neas del intercambio haga click derecho
    y seleccione Follow TCP Stream. . .
    
    ![image.png](image%202.png)
    

c. Usando el cliente de correo Thunderbird del usuario
[alumnopop@redes.unlp.edu.ar](mailto:alumnopop@redes.unlp.edu.ar) env√≠e un correo electr√≥nico
[alumnoimap@redes.unlp.edu.ar](mailto:alumnoimap@redes.unlp.edu.ar) el cual debe tener: un asunto, datos en el
body y una imagen adjunta.
i. Verifique las fuentes del correo recibido para entender c√≥mo se utiliza
el header ‚ÄúContent-Type: multipart/mixed‚Äú para poder realizar el env√≠o
de distintos archivos adjuntos.
ii. Extraiga la imagen adjunta del mismo modo que lo hace el cliente de
correo a partir de los fuentes del mensaje.

zzzz

---

### **7. ¬øEs posible enviar m√°s de un correo durante una misma conexi√≥n TCP?**

### üì© **S√≠, es posible**. Esto depende del **protocolo SMTP**, que permite mantener una conexi√≥n abierta para enviar m√∫ltiples correos.

---

### **Casos:**

### **a) MUA ‚Üí MSA (Mail User Agent ‚Üí Mail Submission Agent)**

- ‚úÖ **M√∫ltiples destinatarios del mismo dominio:**
    
    S√≠, se puede usar **una sola conexi√≥n TCP**.
    
    El MUA puede enviar todos los destinatarios dentro del mismo `RCPT TO:` y luego enviar el `DATA` una sola vez.
    
- ‚úÖ **M√∫ltiples destinatarios de distintos dominios:**
    
    T√©cnicamente se puede intentar enviar todos en una sola sesi√≥n, pero **el MSA probablemente divida luego el env√≠o por dominio**.
    
    Algunos MSA pueden requerir **una nueva conexi√≥n** por dominio, dependiendo de la configuraci√≥n de seguridad o pol√≠ticas de relay.
    

---

### **b) MTA ‚Üí MTA (Mail Transfer Agent ‚Üí otro MTA)**

- ‚úÖ **Mismo dominio de destino:**
    
    **S√≠**, el MTA puede reutilizar una sola conexi√≥n TCP para enviar m√∫ltiples correos al mismo servidor de destino.
    
- ‚ö†Ô∏è **Distintos dominios:**
    
    **No**, normalmente se abre **una conexi√≥n distinta por dominio**, ya que se resuelven a diferentes servidores MX (Mail Exchange) v√≠a DNS.
    

---

### **8. ¬øPuede un MSA escuchar en un puerto diferente a los convencionales (25, 587)?**

### ‚úÖ **S√≠, es t√©cnicamente posible**, pero tiene implicancias:

- **Los puertos est√°ndar para MSA son:**
    - **587 (con autenticaci√≥n y STARTTLS)**
    - **465 (con SSL/TLS directo)**
- **Implicancias de usar otro puerto:**
    - El MUA (cliente de correo) debe estar **configurado expl√≠citamente** para ese puerto.
    - Algunos **proveedores de Internet o firewalls bloquean puertos no est√°ndar**, lo que puede dificultar la conectividad.
    - No es compatible con clientes configurados por defecto.

üìå **√ötil en entornos cerrados** o para evitar filtros de tr√°fico.

---

### **9. ¬øPuede un MTA escuchar en un puerto diferente al est√°ndar (25)?**

### ‚úÖ **Tambi√©n es posible**, pero m√°s problem√°tico.

- **Puerto est√°ndar para MTA es el 25.**
- **Implicancias:**
    - Otros servidores que quieran entregar correos a ese MTA **esperan encontrarlo en el puerto 25**.
    - Si se usa otro puerto, **los correos no llegar√°n salvo que se configure espec√≠ficamente cada remitente para usar el nuevo puerto**, lo cual **no es viable a gran escala**.

üìå **Conclusi√≥n:** aunque t√©cnicamente se puede cambiar, en la pr√°ctica **un MTA debe escuchar en el puerto 25** para interoperar correctamente con otros servidores.

---

1. Ejercicio integrador HTTP, DNS y MAIL
Suponga que registr√≥ bajo su propiedad el dominio [redes2024.com.ar](http://redes2024.com.ar/) y dispone de 4
servidores:
‚óè Un servidor DNS instalado configurado como primario de la zona
[redes2024.com.ar](http://redes2024.com.ar/). (hostname: ns1 - IP: 203.0.113.65).
‚óè Un servidor DNS instalado configurado como secundario de la zona
[redes2024.com.ar](http://redes2024.com.ar/). (hostname: ns2 - IP: 203.0.113.66).
    
    ‚óè Un servidor de correo electr√≥nico (hostname: mail - IP: 203.0.113.111).
    Permitir√° a los usuarios env√≠ar y recibir correos a cualquier dominio de Internet.
    ‚óè Un servidor WEB para el acceso a un webmail (hostname: correo - IP:
    203.0.113.8). Permitir√° a los usuarios gestionar v√≠a web sus correos
    electr√≥nicos a trav√©s de la URL [https://webmail.redes2024.com.a](https://webmail.redes2024.com.a/)
    

a. ¬øQu√© informaci√≥n deber√≠a informar al momento del registro para hacer visible a Internet el dominio registrado?
Para que sea visible el dominio [redes2024.com.ar](http://redes2024.com.ar) deberia avisarle al servidor Autoritativo para que lo registre bajo el dominio redes2024.com.ar                 [ ns1, ns2]

b. ¬øQu√© registros ser√≠a necesario configurar en el servidor de nombres? Indique
toda la informaci√≥n necesaria del archivo de zona. Puede utilizar la siguiente
tabla de referencia (eval√∫e la necesidad de usar cada caso los siguientes
campos): Nombre del registro, Tipo de registro, Prioridad, TTL, Valor del
registro.

PREGUNTAR EL JUEVES ACA, EL TTL COMO SE QUE TTL SERIA MEJOR PARA CADA CASO??? QUE CRITERIO DEBERIA ELEGIR

c. ¬øEs necesario que el servidor de DNS acepte consultas recursivas?
Justifique.
d. ¬øQu√© servicios/protocolos de capa de aplicaci√≥n configurar√≠a en cada
servidor?
e. Para cada servidor, ¬øqu√© puertos considera necesarios dejar abiertos a
Internet?. A modo de referencia, para cada puerto indique: servidor, protocolo
de transporte y n√∫mero de puerto.
f. ¬øC√≥mo cree que se conectar√≠a el webmail del servidor web con el servidor de
correo? ¬øQu√© protocolos usar√≠a y para qu√©?
g. ¬øC√≥mo se podr√≠a hacer para que cualquier MTA reconozca como v√°lidos los
mails provenientes del dominio [redes2024.com.ar](http://redes2024.com.ar/) solamente a los que llegan
de la direcci√≥n 203.0.113.111? ¬øAfectar√≠a esto a los mails enviados desde el
Webmail? Justifique.
h. ¬øQu√© caracter√≠stica propia de SMTP, IMAP y POP hace que al adjuntar una
imagen o un ejecutable sea necesario aplicar un encoding (ej. base64)?
i. ¬øSe podr√≠a enviar un mail a un usuario de modo que el receptor vea que el
remitente es un usuario distinto? En caso afirmativo, ¬øC√≥mo? ¬øEs una
indicaci√≥n de una estafa? Justifique
j. ¬øSe podr√≠a enviar un mail a un usuario de modo que el receptor vea que el
destinatario es un usuario distinto? En caso afirmativo, ¬øC√≥mo? ¬øPor qu√© no
le llegar√≠a al destinatario que el receptor ve? ¬øEs esto una indicaci√≥n de una
estafa? Justifique

k. ¬øQu√© protocolo usar√° nuestro MUA para enviar un correo con remitente
[redes@info.unlp.edu.ar](mailto:redes@info.unlp.edu.ar)? ¬øCon qui√©n se conectar√°? ¬øQu√© informaci√≥n ser√°
necesaria y c√≥mo la obtendr√≠a?
l. Dado que solo disponemos de un servidor de correo, ¬øqu√© suceder√° con los
mails que intenten ingresar durante un reinicio del servidor?
m. Suponga que contratamos un servidor de correo electr√≥nico en la nube para
integrarlo con nuestra arquitectura de servicios.
i. ¬øC√≥mo configurar√≠a el DNS para que ambos servidores de correo se
comporten de manera de dar un servicio de correo tolerante a fallos?